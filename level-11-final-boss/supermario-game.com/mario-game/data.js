function applyNewJs(){document.body.addEventListener("keydown",(function(event){32!==event.keyCode&&38!==event.keyCode&&40!==event.keyCode||event.target!==document.body||event.preventDefault()}),!1),document.getElementById("paused")&&document.getElementById("paused").remove(),document.getElementById("mobile-controls")&&document.getElementById("mobile-controls").remove();var paused_el=createElement("div",{id:"paused"}),paused_el_span=createElement("span");paused_el_span.innerText="CLICK TO UNPAUSE",paused_el.appendChild(paused_el_span),body.appendChild(paused_el);var mobile_controls_el=createElement("div",{id:"mobile-controls"}),move_left_el=createElement("div",{id:"move-left",className:"move"}),move_top_el=createElement("div",{id:"move-top",className:"move"}),move_right_el=createElement("div",{id:"move-right",className:"move"}),move_bottom_el=createElement("div",{id:"move-bottom",className:"move"}),move_fire_el=createElement("div",{id:"move-fire",className:"move"}),move_left_el_span=createElement("span"),move_top_el_span=createElement("span"),move_right_el_span=createElement("span"),move_bottom_el_span=createElement("span"),move_fire_el_span=createElement("span");move_left_el.appendChild(move_left_el_span),move_top_el.appendChild(move_top_el_span),move_right_el.appendChild(move_right_el_span),move_bottom_el.appendChild(move_bottom_el_span),move_fire_el.appendChild(move_fire_el_span),mobile_controls_el.appendChild(move_left_el),mobile_controls_el.appendChild(move_top_el),mobile_controls_el.appendChild(move_right_el),mobile_controls_el.appendChild(move_bottom_el),mobile_controls_el.appendChild(move_fire_el),body.appendChild(mobile_controls_el);var move_right=document.getElementById("move-right"),move_left=document.getElementById("move-left"),move_top=document.getElementById("move-top"),move_bottom=document.getElementById("move-bottom"),move_fire=document.getElementById("move-fire");move_right.addEventListener("touchstart",(function(event){var keyd=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:68});document.body.dispatchEvent(keyd)})),move_right.addEventListener("touchend",(function(event){var keyd=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,keyCode:68});document.body.dispatchEvent(keyd)})),move_left.addEventListener("touchstart",(function(event){var keya=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:65});document.body.dispatchEvent(keya)})),move_left.addEventListener("touchend",(function(event){var keya=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,keyCode:65});document.body.dispatchEvent(keya)})),move_top.addEventListener("touchstart",(function(event){var keyw=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:87});document.body.dispatchEvent(keyw)})),move_top.addEventListener("touchend",(function(event){var keyw=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,keyCode:87});document.body.dispatchEvent(keyw)})),move_bottom.addEventListener("touchstart",(function(event){var keys=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:83});document.body.dispatchEvent(keys)})),move_bottom.addEventListener("touchend",(function(event){var keys=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,keyCode:83});document.body.dispatchEvent(keys)})),move_fire.addEventListener("touchstart",(function(event){var keys=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,keyCode:17});document.body.dispatchEvent(keys)})),move_fire.addEventListener("touchend",(function(event){var keys=new KeyboardEvent("keyup",{bubbles:!0,cancelable:!0,keyCode:17});document.body.dispatchEvent(keys)})),document.getElementById("data_display").style="width:100%;font-size:13px"}function resetData(){var check;(check=document.getElementById("data_display"))&&body.removeChild(check),window.data||(window.data=new Data)}function Data(){this.playerpower=3,this.traveled=this.traveledold=0,this.scorelevs=[100,200,400,500,800,1e3,2e3,4e3,5e3,8e3],this.score=new DataObject(0,6,"SCORE"),this.time=new DataObject(350,3,"TIME"),this.world=new DataObject(0,0,"WORLD"),this.coins=new DataObject(0,0,"COINS"),this.lives=new DataObject(3,1,"LIVES"),this.time.dir=-1,this.scoreold=0}function DataObject(amount,length,name){this.amount=amount,this.length=length,this.name=name,this.element=createElement("td",{className:"indisplay"})}function setDataDisplay(){var display=createElement("table",{id:"data_display",className:"display",style:{width:gamescreen.right+14+"px"}}),elems=["score","coins","world","time","lives"];for(var i in body.appendChild(display),data.display=display,elems)display.appendChild(data[elems[i]].element),updateDataElement(data[elems[i]]);body.appendChild(data.display),is_mobile&&applyNewJs()}function clearDataDisplay(){body.removeChild(data_display)}function toggleLuigi(){window.luigi=!window.luigi,localStorage.luigi=window.luigi,window.player.title=window.luigi?"Luigi":"Mario",setThingSprite(window.player)}function startDataTime(){TimeHandler.addEventInterval(updateDataTime,25,1/0,data.time)}function updateDataTime(me){1!=me.dir&&(100==me.amount?playCurrentThemeHurry():me.amount<=0&&killPlayer(player,!0)),notime||(map.time=me.amount+=me.dir,updateDataElement(me))}function updateDataElement(me){var text=me.name+"<br />"+("Infinity"==me.amount?"Inf":me.amount);me.element.innerHTML=text,me.element.style.width=""}function score(me,amount,appears){if(!(amount<=0)){if(1==arguments.length)return score(player,me);if(localStorage.highscore=max(localStorage.highscore,data.score.amount+=amount),appears){var text=addText(amount,me.left,me.top);text.yvel=-unitsized4,TimeHandler.addEvent(killScore,49,text)}for(;data.score>1e4;)gainLife(),data.score.amount=data.score.amount%1e4;updateDataElement(data.score)}}function killScore(text){body.contains(text)&&body.removeChild(text),killNormal(text),deleteThing(text,texts,texts.indexOf(text))}function findScore(lev){return lev<data.scorelevs.length?data.scorelevs[lev]:(gainLife(),-1)}function gainLife(num,nosound){data.lives.amount+="number"==typeof num?num:1,nosound||AudioPlayer.play("Gain Life"),updateDataElement(data.lives)}function setLives(num){data.lives.amount=Number(num),updateDataElement(data.lives)}function storePlayerStats(){data.playerpower=player.power}function clearPlayerStats(){data.playerpower=player.power=3}