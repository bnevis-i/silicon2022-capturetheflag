function resetMaps(){var mapfunc;window.currentmap=[1,1],window.defaultsetting={setting:"Overworld"},window.mapfuncs=new Array(9);for(var j,i=1;i<=9;++i)for(j=(mapfunc=mapfuncs[i]=[0,0,0,0,0]).length;j>=0;--j)mapfunc[j]=window["World"+i+j];mapfuncs.Random={Overworld:WorldRandomOverworld,Underworld:WorldRandomUnderworld,Underwater:WorldRandomUnderwater,Bridge:WorldRandomBridge,Sky:WorldRandomSky,Castle:WorldRandomCastle},mapfuncs.Special={Blank:BlankMap}}function Map(){this.underwater=this.current_character=this.current_solid=this.current_scenery=this.xloc=0,this.canscroll=!0,this.floor=104,this.time=400,this.curloc=-1,this.gravity=gravity,this.maxyvel=1.75*unitsize,this.maxyvelinv=-2.1*this.maxyvel}function Area(setting,rawfunc){this.creation=rawfunc||function(){},this.precharacters=[],this.presolids=[],this.prescenery=[],this.floor=140,this.width=0,this.underwater=!1,setAreaSetting(this,setting||"")}function setAreaSetting(area,setting,sound){map.shifting=!0,1==arguments.length&&(setting=arguments[0]||"Overworld",area=map.area),area.setting=area.background=setting,area.theme=setting.split(" ")[0],area.fillStyle=getAreaFillStyle(area.setting),-1!=area.fillStyle.indexOf("Underwater")?goUnderWater():goOntoLand(),sound&&AudioPlayer.playTheme(),gameon&&clearAllSprites(),map.shifting=!1}function Location(area,entry,xloc){this.area=area,this.xloc=xloc||0,this.yloc=this.floor=0,this.entry=1==entry?entryPlain:entry||entryNormal}function PreThing(xloc,yloc,type){this.xloc=xloc,this.yloc=yloc,this.type=type;var args=arrayMake(arguments),object=new Thing;args[2]=type,args=args.splice(2),Thing.apply(object,args),this.object=object}function setMap(one,two){if(gameon){!window.canedit&&window.editing&&editorClose(!0),removeRandomDisplays(),one instanceof Array&&(two=one[1],one=one[0]);var newcurrentmap=one?[one,two]:window.currentmap,newmap=new Map,func=mapfuncs[newcurrentmap[0]];func?(newcurrentmap.func=func=func[newcurrentmap[1]],func?(window.map=newmap,window.currentmap=newcurrentmap,func(newmap),newmap.areanum=newmap.curloc=0,window.area=newmap.area=newmap.areas[0],window.player&&player.power&&storePlayerStats(),window.data&&(data.scoreold=data.score.amount),shiftToLocation(0)):log("No such map exists (yet?):",func)):log("No such map section exists (yet?):",func)}}function setMapRandom(transport){gameon&&(resetSeed(),"string"==typeof transport?transport=["Random",transport]:transport||(transport=["Random","Overworld"]),setMap(transport[0],transport[1]),data.traveledold=data.traveled,map.sincechange=map.num_random_sections=0,map.entrancetype=transport[2],map.random=!0,"Sky"==map.randname&&(map.exitloc=["Random","Overworld","Down"]))}function shiftToLocation(loc){if(map.random&&"number"!=typeof loc)return setMapRandom(loc);"number"==typeof loc&&(loc=map.locs[loc]),pause(),resetGameState(),resetGameScreenPosition(),resetQuadrants(),map.areanum=loc.area,window.area=map.area=map.areas[map.areanum],setAreaPreCreation(area),area.creation(),setAreaPostCreation(area),spawnMap(),player=placePlayer(),scrollPlayer(loc.xloc*unitsize),locMovePreparations(player),unpause(),loc.entry(player,loc.entrything),TimeHandler.addEvent(AudioPlayer.playTheme,2),TimeHandler.addEventInterval(checkTexts,117,1/0)}function setAreaPreCreation(area){window.events=[],TimeHandler.clearAllEvents(),window.characters=[],window.solids=[],window.scenery=[],clearTexts(),area.precharacters=[],area.presolids=[],area.prescenery=[],map.current_solid=map.current_character=map.current_scenery=map.shifting=0,map.canscroll=!0,data.time.amount=map.time,data.world.amount=currentmap[0]+"-"+currentmap[1],setDataDisplay(),startDataTime(),map.random&&(data.world.amount="Random Map",data.world.element.innerHTML="WORLD<br>Random Map")}function clearTexts(){if(window.texts)for(var i=texts.length-1;i>=0;--i)texts[i]&&removeChildSafe(texts[i],body);window.texts=[]}function setAreaPostCreation(){if(map.current_character=map.current_solid=map.current_scenery=0,area.width=max(area.width,gamescreen.width),map.underwater=map.area.underwater,map.jumpmod=1.056+3.5*map.underwater,map.has_lakitu=!1,TimeHandler.addEvent(setMapGravity,1),area.underwater&&(area.presolids.push(new PreThing(0,0,WaterBlock,area.width)),map.random||area.presolids.push(new PreThing(0,16,Sprite,"Water",[area.width/3,1]))),area.presolids.sort(prethingsorter),area.precharacters.sort(prethingsorter),area.prescenery.sort(prethingsorter),area.sections&&area.sections[0])setBStretch(),area.sections.current=0,area.sections[0](area.sections.start);else if(!map.random&&"Sky"!=area.setting){var blocker=new PreThing(area.width,0,ScrollBlocker);area.presolids.push(blocker)}area.fillStyle=getAreaFillStyle(area.setting)}function getAreaFillStyle(setting){return stringHas(setting,"Underworld")||stringHas(setting,"Castle")||stringHas(setting,"Night")?stringHas(setting,"Underwater")?"#2038ec":"black":stringHas(setting,"Underwater")?"#2038ec":"#5c94fc"}function prethingsorter(a,b){return a.xloc==b.xloc?b.yloc-a.yloc:a.xloc-b.xloc}function setLocationGeneration(num){map.curloc=num,map.refx=map.locs[map.curloc].xloc,map.refy=map.locs[map.curloc].yloc+map.floor,map.areanum=map.locs[map.curloc].area}function spawnMap(){var arr,arrlen,prething,thing,current,area=map.area,rightdiff=QuadsKeeper.getOutDifference(),screenright=gamescreen.right+rightdiff,screenrightpq=screenright+(2*QuadsKeeper.getQuadWidth()+rightdiff);for(arrlen=(arr=area.precharacters).length,current=map.current_character;arrlen>current&&screenright>=(prething=arr[current]).xloc*unitsize;)thing=prething.object,addThing(thing,prething.xloc*unitsize-gamescreen.left,prething.yloc*unitsize),thing.placenum=current,++current;for(map.current_character=current,arrlen=(arr=area.presolids).length,current=map.current_solid;arrlen>current&&screenrightpq>=(prething=arr[current]).xloc*unitsize;)thing=prething.object,addThing(thing,prething.xloc*unitsize-gamescreen.left,prething.yloc*unitsize),thing.placenum=current,++current;for(map.current_solid=current,arrlen=(arr=area.prescenery).length,current=map.current_scenery;arrlen>current&&screenrightpq>=(prething=arr[current]).xloc*unitsize;)thing=prething.object,addThing(thing,prething.xloc*unitsize-gamescreen.left,prething.yloc*unitsize),thing.placenum=current,++current;map.current_scenery=current}function goToTransport(transport){transport instanceof Array?(map.ending=!0,storePlayerStats(),pause(),map.random?setMapRandom(transport):setMap(transport)):shiftToLocation(map.locs[transport]),is_mobile&&applyNewJs()}function entryPlain(me){setLeft(me,unitsizet16),setBottom(me,map.floor*unitsize),me.nocollide=me.piping=!1,me.placed=!0}function entryNormal(me){setLeft(me,unitsizet16),setTop(me,unitsizet16),me.nocollide=me.piping=!1,me.placed=!0}function entryBlank(me){setLeft(me,unitsizet16),setBottom(me,map.floor*unitsize),me.nocollide=me.piping=me.movement=!1,me.placed=me.nofall=me.nocollide=notime=nokeys=!0,thingStoreVelocity(me),clearDataDisplay()}function entryRandom(me){switch(data.time.amount=0,data.time.dir=1,updateDataElement(data.time),map.startwidth?map.nofloor||pushPreFloor(0,0,map.startwidth):map.startwidth=0,map.firstRandomThings(map),map.randtype(8*(map.startwidth+1)),entryPlain(me),addDistanceCounter(),addSeedDisplay(),map.entrancetype){case"Down":entryNormal(player);break;case"Up":locMovePreparations(player),exitPipeVert(player,addThing(new Thing(Pipe,32),unitsizet8,(map.floor-32)*unitsize));break;case"Vine":locMovePreparations(player),TimeHandler.addEvent((function(){enterCloudWorld(player,!0)}),1),player.nofall=!0,spawnMap();break;case"Castle":startCastle(player)}}function enterCloudWorld(me){map.random&&(map.exitloc=getAfterSkyTransport());var screenbottom=140*unitsize,screentop=72*unitsize;me.placed=me.nofall=!0,setTop(me,screenbottom),setLeft(me,30*unitsize),removeClass(me,"jumping"),addClasses(me,["climbing","animated"]),me.climbing=TimeHandler.addSpriteCycle(me,["one","two"],"climbing"),me.attached=new Thing(Vine,-1),addThing(me.attached,unitsizet32,screenbottom-unitsizet8);var movement=setInterval((function(){if(me.attached.top<=screentop){clearInterval(movement),setTop(me.attached,screentop,!0),me.attached.movement=!1;var stopheight=me.attached.top+unitsizet16;movement=setInterval((function(){shiftVert(me,-1*unitsized4,!0),me.top<=stopheight&&(removeClass(me,"animated"),clearInterval(movement),setTop(me,stopheight,!0),clearInterval(movement),setTimeout((function(){setLeft(me,36*unitsize,!0),addClass(me,"flipped"),setTimeout((function(){playerHopsOff(me,me.attached,!0),TimeHandler.clearClassCycle(me,"climbing"),me.running=TimeHandler.addSpriteCycle(me,["one","two","three","two"],"running",setPlayerRunningCycler)}),28*timer)}),14*timer))}),timer)}}),timer)}function walkToPipe(){player=placePlayer(),startWalking(player),map.canscroll=!1;var move=setInterval((function(){player.piping&&(AudioPlayer.pauseTheme(),clearInterval(move),player.maxspeed=player.maxspeedsave)}),timer);unpause()}function startWalking(me){me.movement=movePlayer,me.maxspeed=me.walkspeed,nokeys=notime=me.keys.run=!0,me.nofall=me.nocollide=!1}function intoPipeVert(me,pipe,transport){if(!(!pipe.transport||!me.resting||me.right+unitsizet2>pipe.right||me.left-unitsizet2<pipe.left)){pipePreparations(me),switchContainers(me,characters,scenery),unpause();var move=setInterval((function(){shiftVert(me,unitsized4,!0),me.top>=pipe.top&&(clearInterval(move),setTimeout((function(){goToTransport(transport)}),700))}),timer)}}function intoPipeHoriz(me,pipe,transport){pipePreparations(me),switchContainers(me,characters,scenery),unpause();var move=setInterval((function(){shiftHoriz(me,unitsized4,!0),me.left>=pipe.left&&(clearInterval(move),setTimeout((function(){goToTransport(transport)}),700))}),timer)}function pipePreparations(me){AudioPlayer.pauseTheme(),AudioPlayer.play("Pipe"),locMovePreparations(me),me.nofall=me.nocollide=nokeys=notime=!0,me.movement=me.xvel=me.yvel=0}function locMovePreparations(me){me.keys=new Keys,me.nocollide=me.piping=1,me.placed=!1,removeCrouch(),removeClass(me,"running"),removeClass(me,"jumping"),removeClass(me,"flipped")}function startCastle(me){(me=me||window.player)&&(setBottom(me,56*unitsize),setLeft(me,unitsizet2),me.nocollide=me.piping=!1,me.placed=!0)}function exitPipeVert(me,pipe){switchContainers(me,characters,scenery),me.nofall=nokeys=notime=!0,AudioPlayer.play("Pipe"),setTop(me,pipe.top),setMidXObj(me,pipe,!0);var dy=unitsize/-4,move=setInterval((function(){shiftVert(me,dy,!0),me.bottom<=pipe.top&&(switchContainers(me,scenery,characters),clearInterval(move),me.nocollide=me.piping=me.nofall=nokeys=notime=!1,me.placed=!0)}),timer)}function endLevel(){map.ending||(map.ending=!0,map.random?setMapRandom(["Random","Castle"]):setNextLevelArr(currentmap),storePlayerStats(),pause(),setMap())}function setExitLoc(num){map.exitloc=num}function pushPreThing(type,xloc,yloc,extras,more){var prething=new PreThing(map.refx+xloc,map.refy-yloc,type,extras,more),object=prething.object;return!object.solid&&!object.character||object.nostretch||(map.area.width=max(map.area.width,prething.xloc+object.width)),object.solid&&!object.spawn_as_char?map.area.presolids.push(prething):map.area.precharacters.push(prething),prething}function pushPreScenery(name,xloc,yloc,repx,repy){repx=round(repx||1),repy=round(repy||1);var prething=new PreThing(map.refx+xloc,map.refy-yloc,Sprite,name,[repx,repy]);return prething.yloc-=prething.object.height,map.area.prescenery.push(prething),prething}function pushPreScenerySolid(name,xloc,yloc,repx,repy){repx=repx||1,repy=repy||1;var prething=new PreThing(map.refx+xloc,map.refy-yloc,Sprite,name,[repx,repy]);return prething.yloc-=prething.object.height,map.area.presolids.push(prething),prething}function pushPreText(settings,xloc,yloc){var prething=new PreThing(map.refx+xloc,map.refy-yloc,FuncSpawner,spawnText,settings);return map.area.presolids.push(prething),prething}function fillPreThing(type,xloc,yloc,numx,numy,width,height,extras,more){for(var y,j,x=xloc,i=0;i<numx;++i){for(y=yloc,j=0;j<numy;++j)pushPreThing(type,x,y,extras,more),y+=height;x+=width}}function pushPreFloor(xloc,yloc,length){pushPreThing(Floor,xloc,yloc||0,length||1,DtB(yloc,8))}function makeCeiling(xloc,num){num=num||1;for(var i=0;i<num;++i)pushPreThing(Brick,xloc+8*i,ceillev)}function makeCeilingCastle(xloc,bwidth,bheight){pushPreThing(Stone,xloc,ceillev,bwidth||1,bheight||1)}function pushPreBridge(xloc,yloc,length,sides){pushPreScenery("Railing",xloc,yloc,2*length),pushPreThing(BridgeBase,xloc,yloc,length),sides instanceof Array&&(sides[0]&&pushPreThing(Stone,xloc-8,yloc,1,64),sides[1]&&pushPreThing(Stone,xloc+8*length,yloc,1,64))}function fillPreWater(xloc,yloc,width){var dtb=DtB(yloc),numy=ceil(dtb/5.5),dtby=5*numy;pushPreScenery("Water",xloc,yloc-5.5,4*width/3),pushPreScenery("WaterFill",xloc,yloc-dtby-15.5,4*width/3,numy+2)}function pushPrePlatformGenerator(xloc,width,dir){pushPreThing(PlatformGenerator,xloc,ceilmax+16,width,dir)}function pushPreScale(xloc,yloc,width,settings){var platwidth=settings[0],offx=2*platwidth,offy1=settings[1]+1.5,offy2=settings[2]+1.5,me=pushPreThing(Scale,xloc,yloc,width).object;platleft=pushPreThing(Platform,xloc-offx,yloc-4*offy1,platwidth,moveFallingScale).object,platright=pushPreThing(Platform,xloc+4*width-platwidth-6,yloc-4*offy2,platwidth,moveFallingScale).object,platleft.parent=me,platright.parent=me,platleft.partner=platright,platright.partner=platleft,platleft.tension=offy1*unitsizet4-10*unitsize,platright.tension=offy2*unitsizet4-10*unitsize,me.tensionleft=offy1*unitsize,me.tensionright=offy2*unitsize,platleft.string=pushPreScenery("String",xloc,yloc-4*offy1,1,4*(offy1-.5)).object,platright.string=pushPreScenery("String",xloc+4*width-1,yloc-4*offy2,1,4*(offy2-.5)).object}function pushPreWarpWorld(xloc,yloc,worlds,offset,block){1==worlds.length&&(worlds=[-1,worlds[0],-1]);var pipe,i,startx=(offset||0)+xloc+10,len=worlds.length;warp=pushPreThing(WarpWorld,xloc,yloc+ceilmax).object;var title=pushPreText({innerText:"WELCOME TO WARP ZONE!",style:{visibility:"hidden"}},startx,58);for(warp.texts.push(title.object),i=0;i<len;++i)-1!=worlds[i]&&(warp.pipes.push(pipe=pushPrePipe(startx,yloc,24,!0,worlds[i]).object),warp.pirhanas.push(pipe.pirhana),worlds[i]instanceof Array&&warp.texts.push(pushPreText({innerText:worlds[i][0],style:{visibility:"hidden"}},startx+4,38).object)),startx+=32;block&&(window.block=pushPreThing(ScrollBlocker,xloc,ceilmax),pushPreThing(ScrollBlocker,startx+16,ceilmax))}function goUnderWater(){window.map&&(map.area&&(window.player&&!map.shifting&&setAreaSetting(String(map.area.setting||"")+" Underwater"),map.area.underwater=!0),setMapGravity(),TimeHandler.clearEvent(map.bubbling),map.bubbling=TimeHandler.addEventInterval(playerBubbles,96,1/0),map.underwater=!0)}function goOntoLand(){map&&(map.area&&(window.player&&!map.shifting&&setAreaSetting(map.area.setting.replace("Underwater","")||"Overworld"),map.area.underwater=!1),setMapGravity(),TimeHandler.clearEvent(map.bubbling),map.underwater=!1)}function setMapGravity(){window.player&&(map.underwater?player.gravity=gravity/2.8:player.gravity=gravity)}function setBStretch(){window.bstretch=gamescreen.width/8-2}function endCastleOutside(xloc,yloc,castlevel,wall,dist){xloc=xloc||0,yloc=yloc||0,castlevel&&(castlevel=castlev),dist=dist||20;var detect=pushPreThing(FlagDetector,xloc+7,yloc+108).object,detect2=pushPreThing(CastleDoorDetector,xloc+60+8*(0==castlev),8).object;detect.flag=pushPreThing(Flag,xloc+.5,yloc+79.5).object,detect.stone=pushPreThing(Stone,xloc+4,yloc+8).object,detect.top=pushPreThing(FlagTop,xloc+6.5,84).object,detect.pole=pushPreThing(FlagPole,xloc+8,80).object,wall&&pushPreScenery("CastleWall",xloc+dist+72,yloc,wall),0==castlevel&&shiftHoriz(detect2,unitsizet8),pushPreCastle(xloc+dist+16,yloc,castlevel)}function startCastleInside(){pushPreThing(Stone,0,88,5,3),pushPreThing(Stone,0,48,3,DtB(48,8)),pushPreThing(Stone,24,40,1,DtB(40,8)),pushPreThing(Stone,32,32,1,DtB(32,8))}function endCastleInside(xloc,last,hard){var axe=pushPreThing(FuncCollider,xloc+104,48,CastleAxeFalls,[16,24]).object.axe=pushPreThing(CastleAxe,xloc+104,40).object;axe.bridge=pushPreThing(CastleBridge,xloc,24,13).object,axe.chain=pushPreThing(CastleChain,xloc+96.5,32).object,axe.bowser=pushPreThing(Bowser,xloc+69,42,hard).object,pushPreThing(ScrollBlocker,xloc+112,ceilmax),pushPreThing(Stone,xloc,88,32),fillPreWater(xloc,0,26),pushPreFloor(xloc+104,32,3),pushPreFloor(xloc+104,0,19),pushPreThing(Stone,xloc+112,80,2,3),pushPreThing(ScrollBlocker,xloc+256,ceilmax),endCastleInsideFinal(xloc,last)}function endCastleInsideFinal(xloc,last){var stopper=pushPreFuncCollider(xloc+180,collideCastleNPC).object,style={visibility:"hidden"};last?(pushPreThing(Peach,xloc+194,13).object,stopper.text=[pushPreText({innerHTML:"<span class='span'>THANK YOU "+window.player.title.toUpperCase()+"!</span>",style:style},xloc+160,66).object,pushPreText({innerHTML:"<span class='span'>"+z()+"</span>",style:style},xloc+148,50).object]):(pushPreThing(Toad,xloc+194,12).object,stopper.text=[pushPreText({innerHTML:"<span class='span'>THANK YOU "+window.player.title.toUpperCase()+"!</span>",style:style},xloc+160,66).object,pushPreText({innerHTML:"<span class='span'>BUT OUR PRINCESS IS IN<BR>ANOTHER CASTLE!</span>",style:style},xloc+148,50).object])}function pushPreSectionPass(xloc,yloc,width,height,secnum){var passer=pushPreThing(Collider,xloc,yloc,[width,height],[sectionPass,sectionColliderInit]).object,section=(secnum=map.area.sections.current||0,map.area.sections[secnum]);section.numpass?++section.numpass:section.numpass=1,section.colliders?section.colliders.push(passer):section.colliders=[passer]}function pushPreSectionFail(xloc,yloc,width,height,secnum){var failer=pushPreThing(Collider,xloc,yloc,[width,height],[sectionFail,sectionColliderInit]).object,section=(secnum=map.area.sections.current||0,map.area.sections[secnum]);section.colliders?section.colliders.push(failer):section.colliders=[failer]}function pushCastleDecider(xloc,secnum){pushPreThing(castleDecider,xloc,ceilmax,xloc,secnum)}function sectionColliderInit(me){me.sections=map.area.sections,me.parent=me.sections[me.sections.current],me.movement=!1}function sectionPass(character,collider){if("player"!=character.type)return!1;collider.nocollide=!0,--collider.parent.numpass||activateSection(collider.parent,!0)}function sectionFail(character,collider){if("player"!=character.type)return!1;collider.nocollide=!0,activateSection(collider.parent,!1)}function activateSection(parent,status){for(var colliders=parent.colliders,i=colliders.length-1;i>=0;--i)killNormal(colliders[i]);parent.activated=!0,parent.passed=status}function pushPreTree(xloc,yloc,width){pushPreThing(TreeTop,xloc,yloc,width);var dtb=DtB(yloc);pushPreScenerySolid("TreeTrunk",xloc+8,yloc-dtb-8,width-2,dtb/8)}function pushPreShroom(xloc,yloc,width){pushPreThing(ShroomTop,xloc,yloc,width);var dtb=DtB(yloc-4);pushPreScenery("ShroomTrunk",xloc+4*width-4,yloc-dtb-8,1,dtb/8)}function pushPrePipe(xloc,yloc,height,pirhana,intoloc,exitloc){isFinite(height)||(height=gamescreen.height,yloc-=gamescreen.height);var prepipe=pushPreThing(Pipe,xloc,yloc+height,height/8,intoloc),pipe=prepipe.object;return pirhana&&(pipe.pirhana=pushPreThing(Pirhana,xloc+4,yloc+height+12).object),exitloc&&(map.locs[exitloc].entrything=pipe,map.locs[exitloc].xloc=xloc),prepipe}function pushPreCastle(xloc,yloc,big){xloc=xloc||0,yloc=yloc||0,big?pushPreCastleBig(xloc,yloc):pushPreCastleSmall(xloc,yloc)}function pushPreCastleBig(xloc,yloc){var i,j;for(pushPreCastleSmall(xloc+16,yloc+48),i=0;i<3;++i)for(j=0;j<2;++j)pushPreScenerySolid("BrickPlain",xloc+16+16*i,yloc+24+8*j);for(i=0;i<2;++i)pushPreScenerySolid("CastleDoor",xloc+24+16*i,yloc+24);for(i=0;i<5;++i){if(2==i)continue;pushPreScenerySolid("BrickHalf",xloc+16+8*i,yloc+48)}for(i=0;i<2;++i)pushPreScenerySolid("CastleRailing",xloc+8*i,yloc+44);for(i=0;i<5;++i)pushPreScenerySolid("CastleRailingFilled",xloc+16+8*i,yloc+44);for(i=5;i<7;++i)pushPreScenerySolid("CastleRailing",xloc+16+8*i,yloc+44);for(i=0;i<2;++i)for(j=0;j<3;++j)pushPreScenerySolid("BrickPlain",xloc+24+16*i,yloc+8*j);for(i=0;i<3;++i)pushPreScenerySolid("CastleDoor",xloc+16+16*i,yloc);for(i=0;i<2;++i){for(j=0;j<5;++j)pushPreScenerySolid("BrickPlain",xloc+8*i,yloc+8*j);pushPreScenerySolid("BrickHalf",xloc+8*i,yloc+40)}for(i=0;i<2;++i){for(j=0;j<5;++j)pushPreScenerySolid("BrickPlain",xloc+56+8*i,yloc+8*j);pushPreScenerySolid("BrickHalf",xloc+56+8*i,yloc+40)}for(i=0;i<3;++i)for(j=0;j<2;++j)pushPreScenerySolid("BrickHalf",xloc+16+16*i,yloc+20+20*j)}function pushPreCastleSmall(xloc,yloc){var i,j;for(i=0;i<3;++i)pushPreScenerySolid("CastleRailing",xloc+8+8*i,yloc+36);for(i=0;i<2;++i)pushPreScenerySolid("CastleTop",xloc+8+12*i,yloc+24);for(pushPreScenerySolid("CastleRailing",xloc,yloc+20),i=1;i<=3;++i)pushPreScenerySolid("CastleRailingFilled",xloc+8*i,yloc+20);for(pushPreScenerySolid("CastleRailing",xloc+32,yloc+20),i=0;i<2;++i)for(pushPreScenerySolid("BrickHalf",xloc+8*i,yloc),j=0;j<2;++j)pushPreScenerySolid("BrickPlain",xloc+8*i,yloc+4+8*j);for(i=0;i<2;++i)for(pushPreScenerySolid("BrickHalf",xloc+24+8*i,yloc),j=0;j<2;++j)pushPreScenerySolid("BrickPlain",xloc+24+8*i,yloc+4+8*j);pushPreScenerySolid("CastleDoor",xloc+16,yloc)}function pushPreFuncCollider(position,func){return position instanceof Array?(console.log("position",position),pushPreThing(FuncCollider,position[0],position[1],func,[position[2],position[3]])):pushPreThing(FuncCollider,position,ceilmax+40,func)}function pushPreFuncSpawner(xloc,func){return pushPreThing(FuncSpawner,xloc,jumplev1,func)}function zoneEnableLakitu(){map.zone_lakitu=!0,enterLakitu()}function zoneDisableLakitu(){if(map.has_lakitu){var lakitu=map.has_lakitu;map.zone_lakitu=map.has_lakitu=!1,lakitu.lookleft||(lakitu.lookleft=!0,removeClass(lakitu,"flipped")),lakitu.movement=function(me){me.xvel=max(me.xvel-unitsized32,-1*unitsize)}}}function zoneStartCheeps(xloc){pushPreFuncCollider(xloc,zoneEnableCheeps)}function zoneStopCheeps(xloc){pushPreFuncCollider(xloc,zoneDisableCheeps)}function zoneEnableCheeps(me){!map.zone_cheeps&&me.player&&startCheepSpawn()}function zoneDisableCheeps(me){me.player&&(map.zone_cheeps=!1)}function pushPrePattern(name,xloc,yloc,reps){var info,i,j,xpos=xloc,pattern=Scenery.patterns[name];for(i=0;i<reps;++i){for(j in pattern)(info=pattern[j])instanceof Array&&pushPreScenery(info[0],xpos+info[1],yloc+info[2],info[3],info[4]);xpos+=pattern.width}}function DtB(yloc,divider){return(yloc+botmax)/(divider||1)}function BlankMap(map){map.locs=[new Location(0,entryBlank)],map.areas=[new Area("Overworld",(function(){setTimeout(refillCanvas,timer+2)}))]}function z(){return CryptoJS.AES.decrypt("U2FsdGVkX1+YT72edI0foMbtho2I8uxzjzTDoevfP4v3qWS6qYte1ncnWCSAvzeq/KXqFwKPQfLpawka8urmJA==","ca069c5e8c9dbd7dffca6dcaa4cbecd2").toString(CryptoJS.enc.Utf8)}function World11(map){map.locs=[new Location(0,!0),new Location(0,exitPipeVert),new Location(1)],map.areas=[new Area("Overworld",(function(){setLocationGeneration(0);pushPreText("<div style='width:350px;max-height:189px;background-color:#d64d00;border-radius:7px;box-shadow:3px 3px #efb28b inset, -3px -3px black inset;background-image: url(\"Theme/Greeting.gif\"), url(\"Theme/Greeting.gif\"), url(\"Theme/Greeting.gif\"), url(\"Theme/Greeting.gif\");background-repeat: no-repeat;background-position: 7px 7px, 336px 7px, 7px 168px, 336px 168px'>  <p style='text-align:left;padding:7px 0 11px 11px;color:#ffcccc;font-family: Super Plumber Bros;font-size:77px;text-shadow:3px 8px black'>    <span style='font-size:84px'>super</span>    <br><br>    <span style='font-size:81px;line-height:96px'>MARIO BROS.</span>  </p></div><div id='boo' style='text-align:right;color:#ffcccc;margin-top:-7px;width:350px;height:35px;'>&copy;1985 NINTENDO</div><p id='explanation' style='text-align:center;\x3c!--/*text-shadow:2px 2px 1px black;*/--\x3emargin-left:7px;'>  Move: Arrows/WASD  <br>  Fire/Sprint: Shift/CTRL  <br>  Pause/Mute: P/M </p>",20,91),pushPrePattern("backreg",0,0,5),pushPreFloor(0,0,69),pushPreThing(Block,128,jumplev1),pushPreThing(Brick,160,jumplev1),pushPreThing(Block,168,jumplev1,Mushroom),pushPreThing(Goomba,176,8),pushPreThing(Brick,176,jumplev1),pushPreThing(Block,176,jumplev2),pushPreThing(Block,184,jumplev1),pushPreThing(Brick,192,jumplev1),pushPrePipe(224,0,16,!1),pushPrePipe(304,0,24),pushPrePipe(368,0,32),pushPreThing(Goomba,340,8),pushPrePipe(368,0,32),pushPreThing(Goomba,412,8),pushPreThing(Goomba,422,8),pushPrePipe(456,0,32,!1,2),pushPreThing(Block,512,40,[Mushroom,1],!0),pushPreFloor(568,0,15),pushPreThing(Brick,618,jumplev1),pushPreThing(Block,626,jumplev1,Mushroom),pushPreThing(Brick,634,jumplev1),pushPreThing(Brick,640,jumplev2),pushPreThing(Goomba,640,jumplev2+8),pushPreThing(Brick,648,jumplev2),pushPreThing(Brick,656,jumplev2),pushPreThing(Goomba,656,jumplev2+8),pushPreThing(Brick,664,jumplev2),pushPreThing(Brick,672,jumplev2),pushPreThing(Brick,680,jumplev2),pushPreThing(Brick,688,jumplev2),pushPreThing(Brick,696,jumplev2),pushPreFloor(712,0,64),pushPreThing(Brick,728,jumplev2),pushPreThing(Brick,736,jumplev2),pushPreThing(Brick,744,jumplev2),pushPreThing(Brick,752,jumplev1,Coin),pushPreThing(Block,752,jumplev2),pushPreThing(Goomba,776,8),pushPreThing(Goomba,788,8),pushPreThing(Brick,800,jumplev1),pushPreThing(Brick,808,jumplev1,Star),pushPreThing(Block,848,jumplev1),pushPreThing(Koopa,856,12),pushPreThing(Block,872,jumplev1),pushPreThing(Block,872,jumplev2,Mushroom),pushPreThing(Block,896,jumplev1),pushPreThing(Goomba,912,8),pushPreThing(Goomba,924,8),pushPreThing(Brick,944,jumplev1),pushPreThing(Brick,968,jumplev2),pushPreThing(Brick,976,jumplev2),pushPreThing(Brick,984,jumplev2),pushPreThing(Goomba,992,8),pushPreThing(Goomba,1004,8),pushPreThing(Goomba,1024,8),pushPreThing(Goomba,1036,8),pushPreThing(Brick,1024,jumplev2),pushPreThing(Brick,1032,jumplev1),pushPreThing(Block,1032,jumplev2),pushPreThing(Brick,1040,jumplev1),pushPreThing(Block,1040,jumplev2),pushPreThing(Brick,1048,jumplev2),pushPreThing(Stone,1072,8),pushPreThing(Stone,1080,16,1,2),pushPreThing(Stone,1088,24,1,3),pushPreThing(Stone,1096,32,1,4),pushPreThing(Stone,1120,32,1,4),pushPreThing(Stone,1128,24,1,3),pushPreThing(Stone,1136,16,1,2),pushPreThing(Stone,1144,8),pushPreThing(Stone,1184,8),pushPreThing(Stone,1192,16,1,2),pushPreThing(Stone,1200,24,1,3),pushPreThing(Stone,1208,32,1,4),pushPreThing(Stone,1216,32,1,4),pushPreFloor(1240,0,69),pushPreThing(Stone,1240,32,1,4),pushPreThing(Stone,1248,24,1,3),pushPreThing(Stone,1256,16,1,2),pushPreThing(Stone,1264,8,1,1),pushPrePipe(1304,0,16,!1,!1,1),pushPreThing(Brick,1344,jumplev1),pushPreThing(Brick,1352,jumplev1),pushPreThing(Block,1360,jumplev1),pushPreThing(Brick,1368,jumplev1),pushPreThing(Goomba,1392,8),pushPreThing(Goomba,1404,8),pushPrePipe(1432,0,16),pushPreThing(Stone,1448,8),pushPreThing(Stone,1456,16,1,2),pushPreThing(Stone,1464,24,1,3),pushPreThing(Stone,1472,32,1,4),pushPreThing(Stone,1480,40,1,5),pushPreThing(Stone,1488,48,1,6),pushPreThing(Stone,1496,56,1,7),pushPreThing(Stone,1504,64,2,8),endCastleOutside(1580,0,1)})),new Area("Underworld",(function(){setLocationGeneration(2),makeCeiling(32,7),pushPreFloor(0,0,17),fillPreThing(Brick,0,8,1,11,8,8),fillPreThing(Brick,32,8,7,3,8,8),fillPreThing(Coin,33,31,7,2,8,16),fillPreThing(Coin,41,63,5,1,8,8),pushPreThing(PipeSide,104,16,1),pushPreThing(PipeVertical,120,88,88)}))]}function World84(map){map.locs=[new Location(0,startCastle),new Location(0,exitPipeVert),new Location(1,exitPipeVert),new Location(2,exitPipeVert),new Location(3,exitPipeVert,24),new Location(4,exitPipeVert)],map.areas=[new Area("Castle",(function(){setLocationGeneration(0),startCastleInside(),pushPreThing(Stone,40,24,1,DtB(24,8)),makeCeilingCastle(40,32),fillPreWater(48,0,10),pushPreThing(Stone,88,0,8,DtB(0,8)),pushPrePipe(152,16,1/0,!0,!1,1),pushPreFloor(168,0,11),this.sections={start:256,0:function(xloc){pushPreFloor(xloc,0,bstretch),makeCeilingCastle(xloc,bstretch+53),pushPreSectionFail(xloc,80,40,80),pushPrePipe(xloc+8*bstretch,16,1/0,!0,1),pushPreFloor(xloc+8*bstretch+16,0,9),fillPreThing(Goomba,xloc+8*bstretch+36,8,3,1,12),pushPreFloor(xloc+8*bstretch+88,24,4),fillPreWater(xloc+8*bstretch+120,0,34),pushPreThing(Platform,xloc+8*bstretch+152,0,4,[moveSliding,xloc+8*bstretch+140,xloc+8*bstretch+232,2]),pushPreFloor(xloc+8*bstretch+256,24,6),pushPreThing(Stone,xloc+8*bstretch+264,56,4),pushPrePipe(xloc+8*bstretch+304,40,1/0,!0,2),pushPreFloor(xloc+8*bstretch+320,24,7),pushPrePipe(xloc+8*bstretch+376,48,1/0,!0),pushPreFloor(xloc+8*bstretch+392,24,4),pushCastleDecider(xloc+8*bstretch+424,0)}}})),new Area("Castle",(function(){setLocationGeneration(2),setBStretch(),pushPreFloor(0,0,bstretch),makeCeilingCastle(0,bstretch),this.sections={start:8*bstretch,0:function(xloc){pushPreSectionFail(xloc,80,40,80),pushPrePipe(xloc,16,1/0,!0,!1,2),makeCeilingCastle(xloc,bstretch+45),pushPreFloor(xloc+16,0,5),pushPrePipe(xloc+56,24,1/0,!0),pushPreFloor(xloc+72,0,8),fillPreThing(Beetle,xloc+104,8.5,2,1,16),pushPrePipe(xloc+136,16,1/0,!0,1),pushPreFloor(xloc+152,0,8),pushPreThing(Koopa,xloc+192,32,!1,!0),pushPreThing(Koopa,xloc+208,24,!1,!0),pushPrePipe(xloc+216,24,1/0,!0),fillPreWater(xloc+232,0,6),pushPreFloor(xloc+256,0,13+bstretch),pushPreThing(Block,xloc+280,jumplev1,Coin,!0),pushPreThing(Stone,xloc+296,jumplev1,2),pushPrePipe(xloc+296,jumplev1,24,!0,3),pushPreThing(Koopa,xloc+320,20,!1,!0),pushPreThing(Koopa,xloc+336,24,!1,!0),pushCastleDecider(xloc+360+8*bstretch,0)}}})),new Area("Castle",(function(){setLocationGeneration(3),pushPreFloor(0,0,3),makeCeilingCastle(0,3),this.sections={start:24,0:function(xloc){pushPreSectionFail(xloc,80,40,80),pushPrePipe(xloc,16,1/0,!0,!1,3),makeCeilingCastle(xloc,bstretch+38),pushPreFloor(xloc+16,0),pushPreFloor(xloc+24,24,6),pushPrePipe(xloc+72,40,1/0,!0),pushPreFloor(xloc+88,24,6),pushPrePipe(xloc+136,48,1/0,!0,1),pushPreFloor(xloc+152,24,6),fillPreWater(xloc+200,0,8),pushPreFloor(xloc+232,24,4),pushPrePipe(xloc+264,40,1/0,!0,4),pushPreFloor(xloc+280,24,bstretch),pushPreFloor(xloc+280+8*bstretch,0,3),pushCastleDecider(xloc+304+8*bstretch,0)}}})),new Area("Underwater Castle",(function(){setLocationGeneration(4),goUnderWater(),pushPreThing(Stone,0,88,2,DtB(88,8)),pushPreFloor(16,0,1,62),pushPrePipe(24,-200,216,!1,!1,4),pushPreFloor(40,0,67),pushPreThing(Stone,48,24,5,3),pushPreThing(Stone,48,80,5,2),pushPreThing(Stone,48,88,66,1),pushPreThing(Stone,88,32,7,4),pushPreThing(Stone,88,80,7,3),pushPreThing(CastleBlock,160,46,[6,1],!0),pushPreThing(Blooper,224,16),pushPreThing(CastleBlock,248,22,[6,1],!0),pushPreThing(Stone,312,24,3,3),pushPreThing(Stone,312,80,3,3),pushPreThing(CastleBlock,320,54,[6,1],!0),pushPreThing(Blooper,408,24),pushPreThing(Blooper,424,56),pushPreThing(CastleBlock,446,38,[6,1],!0),pushPreThing(CastleBlock,512,44,[6,1],!0),pushPreThing(Stone,536,32,5,4),pushPreThing(Stone,536,80,5,3),pushPreThing(PipeSide,544,48,5),pushPreThing(Stone,552,56,3,3)})),new Area("Castle",(function(){setLocationGeneration(5),pushPrePipe(0,16,1/0,!0,!1,5),makeCeilingCastle(0,29),pushPreFloor(16,0,5),pushPrePipe(56,16,1/0,!0),pushPreFloor(72,0,9),pushPreThing(HammerBro,112,12),fillPreWater(128,0,14),pushPreThing(Podoboo,160,-32),pushPreFloor(184,24,6),pushPreThing(Stone,184,80,6,2),endCastleInside(232,1,1)}))]}function randMapType(map){map.locs=[new Location(0,entryRandom)],map.areas=[new Area(map.areatype,(function(){setLocationGeneration(0),"Underwater"==map.randname&&(goUnderWater(),pushPreScenery("Water",0,ceilmax-21,8*(map.startwidth+1)/3,1),pushPreThing(WaterBlock,0,ceilmax,8*(map.startwidth+1)))}))],map.treefunc=randTrue(3)?pushPreTree:pushPreShroom,map.treeheight=map.treelev=map.sincechange=0}function randDayNight(){return randTrue(3)?"":" Night"}function WorldRandomOverworld(map){map.random=!0,map.randtype=pushRandomSectionOverworld,map.randname="Overworld",map.areatype="Overworld"+randDayNight(),map.firstRandomThings=function(map){for(var i=0;i<10;++i)randTrue()&&pushRandomGroundScenery(8*i)},map.startwidth=14,map.onlysmartkoopas=!1,randMapType(map)}function WorldRandomTrees(map){map.random=!0,map.randtype=pushRandomSectionTrees,map.randname="Overworld",map.areatype="Overworld"+randDayNight(),map.firstRandomThings=function(map){map.treefunc(100,8*(map.treelev=randTrue()+2),randTrue()+4),map.startwidth+=7},map.startwidth=11,map.onlysmartkoopas=randTrue(),randMapType(map)}function WorldRandomUnderworld(map){map.random=!0,map.randtype=pushRandomSectionUnderworld,map.randname=map.areatype="Underworld",map.firstRandomThings=function(map){fillPreThing(Brick,0,8,1,11,8,8)},map.startwidth=randTrue(3)+7,map.onlysmartkoopas=!0,map.respawndist=42,map.entrancetype="Up",randMapType(map)}function WorldRandomUnderwater(map){map.random=!0,map.randtype=pushRandomSectionUnderwater,map.randname="Underwater",map.areatype="Underwater"+randDayNight(),map.firstRandomThings=function(map){},map.startwidth=randTrue(3)+7,map.entrancetype="Up",map.countCheep=map.countBlooper=0,map.respawndist=42,map.onlysmartkoopas=!0,randMapType(map)}function WorldRandomBridge(map){map.random=!0,map.randtype=startRandomSectionBridge,map.randname="Overworld",map.areatype="Overworld"+randDayNight(),map.firstRandomThings=function(map){},map.startwidth=14,randMapType(map)}function WorldRandomSky(map){map.random=!0,map.randtype=startRandomSectionSky,map.randname="Sky",map.areatype="Sky"+randDayNight(),map.entrancetype="Vine",map.firstRandomThings=function(map){pushPreThing(Stone,0,0,4)},map.startwidth=4,map.nofloor=!0,randMapType(map)}function WorldRandomCastle(map){map.random=!0,map.randtype=startRandomSectionCastle,map.randname=map.areatype=map.entrancetype="Castle",map.firstRandomThings=function(map){startCastleInside(),startCastle()},map.respawndist=35,randMapType(map)}