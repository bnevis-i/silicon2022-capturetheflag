function resetSeed(){window.seeder=1777771/(window.seed=round(1e7*random())),window.seedlast=.007,window.getSeed=function(){return seedlast="0."+String(seeder/seedlast).substring(4).replace(".","")}}function pushRandomSectionOverworld(xloc){var bwidth=max(randTrue(117),1),floorlev=0;if(++map.num_random_sections,pushPreFuncCollider(xloc,zoneDisableCheeps),map.had_floor=!1,map.needs_floor||bwidth>=14||bwidth<3||randTrue()?(pushPreFloor(xloc,0,bwidth),map.had_floor=!0):(floorlev=0,pushPreThing(Stone,xloc,floorlev,bwidth)),window.randcount_powerup=3,bwidth<=3&&map.had_floor){if(randTrue())switch(randTrue(3)){case 0:if(bwidth>3){pushPreScenery("HillSmall",xloc,0);break}case 1:if(bwidth>2){pushPreScenery("Bush1",xloc+8*max(0,randTrue(bwidth-2)),floorlev);break}case 2:pushPreScenery("PlantLarge",xloc+8*max(0,randTrue(bwidth-2)),floorlev);break;case 3:pushPreScenery("PlantSmall",xloc+8*max(0,randTrue(bwidth-2)),floorlev)}}else for(var maxwidth=bwidth-2,hadcloud=0,numenemychunks=0,i=randTrue(2);i<maxwidth;i+=3)randTrue(7)&&(randTrue(2)?(map.hadObstacle=!1,(numenemychunks%3==0||randTrue())&&(pushRandomChunkEnemy(xloc,i),++numenemychunks),map.had_floor&&pushRandomGroundScenery(xloc+8*i,i,bwidth)):pushRandomObstacle(xloc,i),!hadcloud&&randTrue()?(pushRandomSkyScenery(xloc+8*i),hadcloud=!0):hadcloud=!1);prepareNextGeneratorStandard(xloc,bwidth,pushRandomSectionOverworld)}function startRandomSectionBridge(xloc){pushPreFuncCollider(xloc-24,zoneDisableCheeps),pushPreFuncCollider(xloc,zoneEnableCheeps);var bwidth=5+randTrue(4),mwidth=bwidth-4;map.needs_bridge=!0,map.treelev=map.treeheight=0,pushPreTree(xloc,0,bwidth+1),pushPreThing(Stone,xloc+16,8,1,1),pushPreThing(Stone,xloc+24,16,1,2),pushPreThing(Stone,xloc+32,24,mwidth,3),pushRandomSectionBridge(xloc+8*(bwidth-1),24,!0),spawnMap(),map.had_floor=!1}function pushRandomSectionBridge(xloc,bheight,nofirstcol){var next_no_unusuals=!1;if(bheight=bheight||24+16*randTrue()-8,randTrue()||map.needs_bridge)if(0===randTrue(3))switch(randTrue()){case 0:var pnum=randTrue(3)+1,bwidth=4*pnum;next_no_unusuals=!0;for(var i=1;i<=2*pnum;i+=2)pushPreBridge(xloc+16*i,bheight,3);break;case 1:bwidth=randTrue(7)+7;var pDtB=DtB(bheight,8);nofirstcol||pushPreThing(Stone,xloc,bheight,1,pDtB),pushPreBridge(xloc+8,bheight,bwidth-1),pushPreThing(Stone,xloc+8*bwidth,bheight,1,pDtB)}else{map.needs_bridge=map.treeheight=0;pDtB=DtB(bheight,8);bwidth=17*(randTrue(3)+3);for(i=0;i<bwidth;i+=17)if(!i&&nofirstcol||pushPreThing(Stone,xloc+8*i,bheight,1,pDtB),pushPreBridge(xloc+8*(i+1),bheight,16),randTrue()&&pushRandomSmallEnemy(xloc+8*(i+8),bheight),randTrue(2)){randTrue();var coinrowsize=3+randTrue(2);pushRandomCoinRow(xloc+8*(i+8),bheight+32,coinrowsize),pushRandomCoinRow(xloc+8*(i+8),bheight+40,getNextCoinRowSize(coinrowsize))}else pushPreThing(Block,xloc+8*(i+8),bheight+jumplev1,Mushroom);pushPreThing(Stone,xloc+8*bwidth,bheight,1,pDtB)}else bwidth=10,pushPreTree(xloc+16,8*randTrue(),bwidth);prepareNextGeneratorStandard(xloc,bwidth+2,randTrue()?pushRandomSectionBridge:pushRandomSectionOverworld,!1,next_no_unusuals)}function pushRandomSectionPreCastle(xloc,num){var chunk,i,bwidth=randTrue(35)+35,maxwidth=bwidth-3,havewall=!1;for(num=num||0,pushPreFloor(xloc,0,bwidth),hadcloud=!1,i=randTrue(3);i<maxwidth;i+=chunk||3){switch(randTrue(3)){case 0:switch(chunk=3,randTrue(2)){case 0:var height=randTrue(2)+1;pushPreThing(Cannon,xloc+8*(i+randTrue(2)),8*height,height);break;case 1:for(var j=0;j<chunk;++j)randTrue()||(height=randTrue(3)+1,pushPreThing(Stone,xloc+8*(i+j),8*height,1,height));break;case 2:pushPrePipe(xloc+8*(i+randTrue()),0,8*(2+randTrue(2)),!0)}break;case 1:switch(chunk=7,havewall=!0,randTrue(2)){case 0:pushPreThing(Koopa,xloc+8*(i+randTrue(7)),12+8*randTrue(3),randTrue(),!0);break;case 1:randTrue()&&pushPreThing(HammerBro,xloc+8*(i+randTrue(7)),12+2*randTrue(3));break;case 2:chunk=10,havewall=!1;for(j=1;j<8;++j)for(var k=jumplev1;k<=jumplev2;k+=32)pushPreThing(Brick,xloc+8*(i+j),k,getRandomBrickItem(!1,randTrue()));var height1=randTrue()?jumplev1:jumplev2;height2=height==jumplev1?jumplev2:jumplev1,randTrue(2)&&pushPreThing(HammerBro,xloc+8*(i+randTrue(3)),height1+12),randTrue(2)&&pushPreThing(HammerBro,xloc+8*(i+4+randTrue(3)),height2+12)}}havewall&&chunk>=7&&(pushPreScenery("CastleWall",xloc+8*(i+randTrue()),0,chunk-randTrue(2)),randTrue()&&pushPreThing(Brick,xloc+8*(i+randTrue(chunk)),jumplev1,randTrue()?Mushroom:getRandomBrickItem(!1,randTrue())));for(k=0;k<chunk;k+=3)randTrue(2)&&pushRandomGroundScenery(xloc+8*(i+k),0),!hadcloud&&randTrue()?(pushRandomSkyScenery(xloc+8*(i+k)),hadcloud=!0):hadcloud=!1}pushPreFloor(xloc+8*bwidth,0,i+3-bwidth);var next=4+randTrue(3);num>=3?endCastleOutsideRandom(xloc+8*(bwidth+next+1),!0):pushRandomSectionPreCastle(xloc+8*(bwidth+next),num+1),spawnMap()}function endCastleOutsideRandom(xloc){var nextwidth,i;switch(randTrue()){case 0:for(i=1+randTrue();i<9;i+=2)pushPreThing(Stone,xloc+8*i,8*(i-randTrue()),1,1+randTrue());pushPreThing(Stone,xloc+72,64,2),nextwidth=12;break;case 1:for(pushPreFloor(xloc,0,11),i=1,hadlast=!1;i<9;++i)!hadlast||randTrue(2)||8==i?(pushPreThing(Stone,xloc+8*i,8*i,1,i),hadlast=!0):(hadlast=!1,pushPrePipe(xloc+8*i,0,8*max(i-randTrue(2),2),!0),++i);pushPreThing(Stone,xloc+72,72,2,9),nextwidth=7}pushPreFloor(xloc+88,0,round(gamescreen.width/8)),endCastleOutside(xloc+8*(9+nextwidth)+4,0,!0,round(gamescreen.width/8))}function startRandomSectionCastle(xloc){xloc+=32;var cwidth=randTrue(7)+3,moat=randTrue(4)+3;randTrue(4);pushPreFloor(xloc,24,cwidth),pushPreThing(Stone,xloc,88,cwidth,3),fillPreWater(xloc+8*cwidth,0,2*moat),pushPreThing(Podoboo,xloc+8*cwidth+max(0,8*randTrue(moat-3)),-32),pushRandomSectionCastle(xloc+8*(cwidth+moat),0),spawnMap()}function pushRandomSectionCastle(xloc,num){var cwidth,nextwidth;switch(randTrue(3)){case 0:nextwidth=64*(cwidth=1+randTrue(2))-8;for(var i=0;i<cwidth;++i)randTrue()?(makeCeilingCastle(xloc+64*i,8),fillPreWater(xloc+64*i,0,16),pushPreThing(Platform,xloc+64*i+8+8*randTrue(2),8+8*randTrue(max(i+2,4)),4,moveFalling)):(pushPreFloor(xloc+64*i-8,8,1),pushPrePlatformGenerator(xloc+64*i+24,4,1.75),pushPreFloor(xloc+64*i+64,8,1));break;case 1:var platoff,platheight,platwidth;nextwidth=64*(cwidth=2*(1+randTrue()))-8,makeCeilingCastle(xloc,8*cwidth),fillPreWater(xloc,0,16*cwidth);for(i=0;i<cwidth;++i){switch(platoff=xloc+64*i,platheight=8*randTrue(max(i+1,2+randTrue(2))),platwidth=2+randTrue(3),randTrue(2)){case 0:pushPreFloor(platoff+8*randTrue(3),platheight,platwidth);break;case 1:pushPreThing(Stone,platoff+8*randTrue(3),platheight,platwidth);break;case 2:platoff+=8+8*randTrue(),pushPreThing(Platform,platoff,8*randTrue(3),4,[moveSliding,platoff,platoff+56+8*randTrue(2),2])}randTrue(2)||platwidth%2!=1||pushPreThing(Block,platoff+4*platwidth-8,platheight+40,Mushroom),platwidth<=4&&pushPreThing(Podoboo,platoff+8*(platwidth+1),-32)}break;case 2:var chunk;switch(nextwidth=8*(cwidth=14+randTrue(21))-8,ceilheight=1,pushPreFloor(xloc,0,cwidth),randTrue()){case 0:ceilheight=3,makeCeilingCastle(xloc,cwidth,ceilheight);for(i=1+randTrue();i<cwidth-6;++i)chunk=min(7,cwidth-i),pushPreThing(Stone,xloc+8*i,jumplev1,chunk),randTrue()&&pushPreThing(CastleBlock,xloc+8*(i+chunk-4),0,[6,randTrue()],!0),pushPreThing(CastleBlock,xloc+8*(i+chunk),jumplev1,6,randTrue()),randTrue()&&pushPreThing(CastleBlock,xloc+8*(i+chunk+4),jumplev2+8,[6,randTrue()],!0),i+=chunk;break;case 1:makeCeilingCastle(xloc,cwidth,ceilheight);var floorlev=randTrue(),off=randTrue();pushPreThing(Stone,xloc,8*floorlev,cwidth,floorlev);for(i=randTrue(2);i<cwidth-3;i+=4)pushPreThing(Stone,xloc+8*(i+off),16+8*floorlev,3,2),pushPreThing(CastleBlock,xloc+8*(i+off+1),24+8*floorlev,randTrue(2)?6:0,randSign()),pushPreThing(Stone,xloc+8*(i+off),80,3,2),i<cwidth-5&&pushPreThing(CastleBlock,xloc+8*(i+off+1),64,randTrue(2)?6:0,randSign()),i+=1+randTrue(3)}break;case 3:nextwidth=8*(cwidth=21+randTrue(21))-8;var floorheight=1+randTrue(3),ceilheight=11-floorheight-4;pushPreFloor(xloc,8*floorheight,cwidth),makeCeilingCastle(xloc,cwidth,ceilheight);for(i=0;i<cwidth;i+=8)randTrue()&&(pushRandomEnemy(xloc+8*i,8*floorheight,0),randTrue()&&(pushRandomEnemy(xloc+8*i+12,8*floorheight,0),randTrue()&&pushRandomEnemy(xloc+8*i+24,8*floorheight,0)))}pushPreThing(GenerationStarter,xloc+nextwidth,ceilmax+20,num<=280?pushRandomSectionCastle:endCastleInsideRandom,num+nextwidth/8),spawnMap()}function endCastleInsideRandom(xloc){var width,num=2+randTrue(2),bottom=8*randTrue(),top=bottom+24+8*randTrue();pushPreFloor(xloc,bottom,5*num);for(var i=0;i<num;++i)width=max(2,randTrue(3)),pushPreFloor(xloc+5*(i+1)*8,top,width);var end=xloc+5*num*8,extra=8*randTrue(7);fillPreWater(end,0,extra),endCastleInsideRandomFinal(end+extra),spawnMap()}function endCastleInsideRandomFinal(xloc){fillPreWater(xloc,0,16),pushPreFloor(xloc+24,24,3),endCastleInside(xloc+48,2),randTrue()&&pushPreThing(Podoboo,xloc+72+8*randTrue(3),-32),randTrue()&&fillPreThing(Brick,xloc+56+8*randTrue(3),64,3+randTrue(3),1,8),randTrue()&&pushPreThing(CastleBlock,xloc+56+8*randTrue(2),24,[6,randSign()],!0),spawnMap()}function placeRandomCastleNPC(xloc){pushPreThing(Toad,xloc+194,12).object.text=[pushPreText({innerHTML:"THANK YOU "+window.player.title.toUpperCase()+"!"},xloc+160,66).object,pushPreText({innerHTML:"LOL YOU THOUGHT THERE WOULD BE SOMETHING HERE DIDN'T YOU!"},xloc+148,50).object]}function pushRandomCoinRow(xloc,yloc,size){if(size){var pattern;if(3==size&&(xloc+=8),randTrue(2))switch(size){case 3:pattern=[1,0,1];break;case 4:switch(randTrue()){case 0:pattern=[1,0,0,1];break;case 1:pattern=[0,1,1,0]}break;case 5:switch(randTrue()){case 0:pattern=[1,0,1,0,1];break;case 1:pattern=[0,1,0,1,0]}}else pattern=arrayOf(!0,size);for(var i=0;i<size;++i)pattern[i]&&pushPreThing(Coin,xloc+8*i,yloc)}}function getNextCoinRowSize(prev){switch(prev){case 3:return 5;case 5:return 3;default:return prev}}function pushRandomSectionTrees(xloc){var treewidth,treeheight,func;switch(randTrue(7)){case 0:var minwidth,topheight;treewidth=randTrue(14)+7,treeheight=randTrue(3),map.treefunc(xloc,8*treeheight,treewidth);for(var i=randTrue(2);i<treewidth-2;i+=minwidth-1)randTrue(2)&&pushRandomSmallEnemy(xloc+8*i,8*treeheight),randTrue(2)&&(minwidth=3+(randTrue(3)?0:randTrue(4)),topheight=8*min(9,treeheight+randTrue(7)+3),map.treefunc(xloc+8*i,topheight,minwidth),randTrue()&&pushRandomSmallEnemy(xloc+8*i,8*topheight),pushRandomSmallEnemy(xloc+8*(i+=minwidth-1),8*treeheight));break;case 1:treewidth=14,treeheight=7,randTrue(),treewidth=4+randTrue(2),pushPrePlatformGenerator(xloc+8*(randTrue()+1),treewidth,-1),treewidth+=randTrue(3)+3;break;default:treewidth=4+randSign()+randTrue(),treeheight=min(randTrue(2)+4+randSign(2),map.treelev+4);var treex=xloc-8*randTrue();if(treeheight==map.treelev&&(treeheight+=randSign()),map.treefunc(treex,8*treeheight,treewidth),treewidth>3||randTrue())if(randTrue(3))pushRandomSmallEnemy(treex+8*(randTrue()+1),8*treeheight);else if(randTrue(2))for(i=1;i<treewidth-1;++i)pushPreThing(Coin,treex+1+8*i,8*(treeheight+1)-1)}++map.sincechange>7&&randTrue()?(func=map.randtype,map.sincechange=0):func=pushRandomSectionTrees,pushPreThing(GenerationStarter,xloc+8*(treewidth+randSign()),ceilmax+20,func),spawnMap(),map.treelev=treeheight}function pushRandomSmallEnemy(xloc,yloc,canjump){switch(randTrue(7)){case 1:case 2:case 3:pushPreThing(Koopa,xloc,yloc+12,!0,canjump);break;case 7:pushPreThing(Beetle,xloc,yloc+8.5);break;default:pushPreThing(Goomba,xloc,yloc+8)}}function pushRandomSectionUnderworld(xloc){var i,j,bwidth=max(randTrue(117),1),maxwidth=bwidth-bwidth%14;floor(bwidth/14);if(pushPreFloor(xloc,0,bwidth),window.randcount_powerup=3,bwidth<14)switch(randTrue()){case 0:for(i=0;i<bwidth-2;i+=3)pushRandomChunkEnemy(xloc+8*i,0,i);break;case 1:for(i=0;i<bwidth-2;i+=3)randTrue(2)?i%3==0&&pushRandomChunkEnemy(xloc,i):pushRandomObstacle(xloc,i)}else for(i=1;i<maxwidth;i+=14)switch(randTrue(5)){case 0:pushRandomUnderworldSquigglies(xloc+8*i,14),makeCeiling(xloc+8*i,14);break;case 1:var diff=1+randTrue(),lev=4+randTrue(7);for(i+=diff,j=0;j<14;j+=1+randTrue()/2)randTrue()&&pushRandomSmallEnemy(xloc+8*(i+j),0);fillPreThing(Brick,xloc+8*i,8*lev,13,12-lev,8,8),i-=diff;break;case 2:createTunnel(xloc+8*(i+2),10,Brick);break;case 3:pushUnderworldPipes(xloc+8*(i+2),12),makeCeiling(xloc+8*(i+1),14);break;case 4:pushUnderworldStones(xloc+8*(i+2),12),makeCeiling(xloc+8*(i+1),14);break;case 5:for(j=0;j<10;j+=3)pushRandomChunkEnemy(xloc+8*(i+j),j);break;case 6:for(j=0;j<bwidth-2;j+=3)randTrue(2)?(i%3==0||randTrue())&&(pushRandomChunkEnemy(xloc+8*(i+j),j),++numenemychunks):pushRandomObstacle(xloc+8*(i+j),j)}prepareNextGeneratorStandard(xloc,bwidth,pushRandomSectionUnderworld,!0),spawnMap()}function pushRandomUnderworldSquigglies(xloc,maxwidth,maxheight,nocoins){maxheight=maxheight||1/0;for(var bottom=3+randTrue(2),top=min(maxheight,bottom+1+randTrue(4)),lev=1==bottom?top:randTrue(2)?bottom:top,diff=1+top-bottom,had_brick=!1,coincap=top+16,i=0;i<maxwidth;++i){if(randTrue()){for(var j=0;j<3;++j)pushPreThing(Brick,xloc+8*(i+j),8*lev,randTrue()?null:getRandomBrickItem());!nocoins&&randTrue(2)&&fillPreThing(Coin,xloc+1+8*i,8*min(coincap,lev+randTrue(4)+1)-1,3+randTrue(),1,8),had_brick||(randTrue()?pushPreThing(Block,xloc+8*(i+3),8*lev,getRandomBlockItem()):pushPreThing(Brick,xloc+8*(i+3),8*lev),had_brick=!0),i+=3}else fillPreThing(Brick,xloc+8*i,8*bottom,1,diff,8,8),lev=lev==top?bottom:top,had_brick=!1;(i%3==1||randTrue()&&i<maxwidth-3)&&pushRandomSmallEnemy(xloc+8*i,0,!1)}}function pushUnderworldPipes(xloc,width){var out,lev,i,maxwidth=width-4,had_ok=!1;for(i=0;i<maxwidth;i+=4)switch(randTrue()){case 0:addPipeRandom(xloc+8*(i+(out=randTrue())),0,8*(2+randTrue(2))),i+=1-out,had_ok=!0;break;case 1:out=randTrue()||!had_ok,lev=4+randTrue(4),out&&pushPreThing(Brick,xloc+8*i,8*max(lev-4,3+randTrue()),getRandomBrickItem(!1)),addPipeRandom(xloc+8*(i+out),0,8*lev),had_ok=!1}for(;i<width-1;++i)randTrue()&&pushRandomChunkEnemy(xloc+8*i,0)}function pushUnderworldStones(xloc,width){var out,lev,i,maxwidth=width-4,had_ok=!1;for(i=0;i<maxwidth;i+=2)switch(randTrue()){case 0:out=randTrue(),lev=2+randTrue(2),pushPreThing(Stone,xloc+8*(i+out),8*lev,1,lev),i+=1-out,had_ok=!0;break;case 1:out=randTrue()||!had_ok,lev=4+randTrue(4),out&&pushPreThing(Brick,xloc+8*i,8*max(lev-4,3+randTrue()),getRandomBrickItem(!1)),pushPreThing(Stone,xloc+8*(i+out),8*lev,1,lev),had_ok=!1}for(;i<width-1;i+=3)randTrue()&&pushRandomChunkEnemy(xloc+8*i,0)}function pushRandomSectionUnderwater(xloc){var bwidth=max(randTrue(117),7);bwidth-=bwidth%3,pushPreFloor(xloc,0,bwidth),pushPreScenery("Water",xloc,ceilmax-21,8*bwidth/3,1),pushPreThing(WaterBlock,xloc,ceilmax,8*bwidth),window.randcount_powerup=3;for(var i=0;i<bwidth;i+=4){switch(randTrue(21)){case 0:if(i<bwidth-2){pushRandomObstacle(xloc,i);break}case 1:pushRandomEnemy(xloc,0,i,!0);break;default:switch(randTrue(7)){case 0:var topblock=randTrue()+2,botblock=randTrue()+2;pushPreThing(Stone,xloc+8*i,8*botblock,randTrue(3)+1,botblock),pushPreThing(Stone,xloc+8*i,ceillev,randTrue(3)+1,topblock);break;case 1:randTrue()&&pushPreThing(Stone,xloc+8*i,jumplev1,4),randTrue()&&pushPreThing(Stone,xloc+8*i,jumplev2,4);break;case 2:fillPreThing(Coin,xloc+8*(i+randTrue())+1,8*(randTrue(8)+1)-1,3,1,8);break;default:if(map.had_coral){map.had_coral=!1;break}map.had_coral=!0;var cy,pwidth=randTrue(3)+2,pheight=jumplev1*(1+randTrue(2)),cx=xloc+8*i;if(pheight==3*jumplev1){var ontop=!0;pheight-=8}pushPreThing(Stone,xloc+8*i,pheight,pwidth),cy=!ontop&&(randTrue(3)||pwidth<=3)?pheight+24:pheight-8,randTrue()&&pushPreThing(Coral,cx,cy,3),randTrue()&&pwidth>3&&pheight<64&&pushPreThing(Coral,cx+8*(pwidth-1),cy,3),pwidth>=3&&(i+=pwidth-3)}}map.countCheep>1&&(pushPreThing(CheepCheep,xloc+8*i,randTrue(80)+8,randTrue()),map.countCheep=0),map.countBlooper>7&&(pushPreThing(Blooper,xloc+8*i,randTrue(80)+8),map.countBlooper=0),randTrue(7)&&++map.countCheep,randTrue(3)&&++map.countBlooper}if(++map.sincechange<3){var tonext=prepareNextGeneratorStandard(xloc,bwidth,pushRandomSectionUnderwater,!1,!0);pushPreScenery("Water",xloc+8*bwidth,ceilmax-21,8*(tonext+1)/3,1),pushPreThing(WaterBlock,xloc+8*bwidth,ceilmax,8*(tonext+1))}else endRandomSectionUnderwater(xloc+8*bwidth)}function endRandomSectionUnderwater(xloc){pushPreFloor(xloc,0,19),pushPreScenery("Water",xloc,ceilmax-21,28,1),pushPreThing(WaterBlock,xloc,ceilmax,157.5),pushPreThing(Stone,xloc,8,5,1),pushPreThing(Stone,xloc+8,16,4,1),pushPreThing(Stone,xloc+16,24,3,1),pushPreThing(Stone,xloc+24,32,2,1),pushPreThing(Stone,xloc+24,88,2,4),pushPreThing(PipeSide,xloc+32,48,["Random",randTrue()?"Overworld":"Underworld","Up"]),pushPreThing(Stone,xloc+40,88,14,11),map.scrollblockerok=!0,pushPreThing(ScrollBlocker,xloc+56,80,!0),spawnMap()}function startRandomSectionSky(xloc){pushPreThing(Stone,xloc,0,78),pushPreThing(Platform,xloc+88,24,6,[collideTransport]),pushRandomSectionSky(xloc+80,1),spawnMap()}function pushRandomSectionSky(xloc,num){if(num++>7)return fillPreThing(Coin,xloc+8,8,3,1,8),spawnMap();var cwidth=0;if(num%2)fillPreThing(Coin,xloc+1,71,3,1,8),cwidth=32;else switch(randTrue(num)){case 3:pushPreThing(Stone,xloc+8,48,1,2),fillPreThing(Coin,xloc+25,63,7,1,8),pushPreThing(Stone,xloc+88,48,1,2),cwidth=104;break;case 4:case 5:case 6:pushPreThing(Stone,xloc+8,56,2);for(var i=0;i<=7;i+=2)pushPreThing(Stone,xloc+8*(i+5),56),fillPreThing(Coin,xloc+8*(i+5)+1,63,2,1,8);cwidth=104;break;default:fillPreThing(Coin,xloc+1,55+8*randTrue(),16,1,8),cwidth=128}pushPreThing(GenerationStarter,xloc+cwidth,ceilmax+20,pushRandomSectionSky,num),spawnMap()}function prepareNextGeneratorStandard(xloc,bwidth,func,allow_platforms,no_unusuals){var nextdist=0,nofancy=0;if(no_unusuals)nextdist=1;else switch(randTrue(7)){case 0:bwidth>7&&map.underwater&&!randTrue(7)?(nextdist=randTrue(3)+7,pushPreThing(Springboard,xloc+8*(bwidth-1),14.5)):nofancy=!0;break;case 1:var numpoles=max(1,randTrue(7));nextdist=numpoles+randTrue(3),pushPreFloor(xloc+8*bwidth,0,numpoles);for(var j=1;j<=numpoles;++j)pushPreThing(Stone,xloc+8*(bwidth+j-1),8*j,1,j);if(randTrue()){numpoles=max(1,randTrue(numpoles)),pushPreFloor(xloc+8*(bwidth+nextdist+numpoles-1),0,numpoles);for(var k=0;k<numpoles;++k)pushPreThing(Stone,xloc+8*(bwidth+nextdist+numpoles+k-1),8*(numpoles-k),1,numpoles-k);nextdist+=numpoles+numpoles-2}break;default:allow_platforms&&randTrue()?(nextdist=randTrue(1)+4,pushPrePlatformGenerator(xloc+8*(bwidth+1.5),2*(nextdist-2),randSign())):nofancy=!0}return(nofancy||!nextdist||nextdist<1)&&(nextdist=randTrue(3)+1),func==pushRandomSectionOverworld&&map.num_random_sections>=3+randTrue(7)&&(func=pushRandomSectionPreCastle),!no_unusuals&&++map.sincechange>3&&(func=getRandomNextSection(),map.sincechange=0,pushPreFuncCollider(xloc,zoneDisableCheeps)),pushPreThing(GenerationStarter,xloc+8*(bwidth+nextdist),ceilmax+20,func),spawnMap(),nextdist}function getRandomNextSection(){switch(randTrue()){case 0:return map.treeheight=0,pushRandomSectionTrees;case 1:return startRandomSectionBridge}}function pushRandomChunkEnemy(xloc,i,noRares){pushRandomEnemy(xloc,0,i,noRares),randTrue(2)&&(pushRandomSolidRow(xloc+8*i,jumplev1,randTrue(2)+1),randTrue()&&pushRandomEnemy(xloc,jumplev1,i+1,!0),randTrue()&&(pushRandomSolidRow(xloc+8*i,jumplev2,randTrue(2)+1),randTrue()&&pushRandomEnemy(xloc,jumplev2,i+1,!0)))}function pushRandomEnemy(xloc,yloc,i,noRares){switch(randTrue(14)){case 0:case 1:fillPreThing(Beetle,xloc+8*i,yloc+8.5,randTrue(2),1,12);break;case 3:if(!noRares){switch(randTrue(4)){case 0:pushPreThing(HammerBro,xloc+8*i,yloc+12),randTrue()&&pushPreThing(HammerBro,xloc+8*i+16,yloc+40);break;case 1:if("Underworld"!=map.randname){pushPreThing(Lakitu,xloc+8*i,yloc+80,!0);break}case 2:pushPreThing(Blooper,xloc+8*i,yloc+40)}break}break;default:if(!randTrue(3))return;if(1===randTrue(3))fillPreThing(Koopa,xloc+8*i,yloc+12,randTrue(2),1,12,0,randTrue()||map.onlysmartkoopas,randTrue());else fillPreThing(Goomba,xloc+8*i,yloc+8,randTrue(2),1,12)}}function addPipeRandom(xloc,yloc,height){var transport;transport=!(height<=24||randTrue(2))&&getRandomTransport(),pushPrePipe(xloc,yloc,height,randTrue(7),transport)}function getRandomTransport(){var locpos,loctypes=[["Overworld","Up"],["Underworld","Down"],["Underwater","Up"]];return loctypes[locpos=randTrue(loctypes.length-1)][0]==map.randname&&(locpos=(locpos+randTrue(loctypes.length-2)+1)%loctypes.length),["Random",loctypes[locpos][0],loctypes[locpos][1]]}function getAfterSkyTransport(){return 0===randTrue(3)?["Random","Underworld","Down"]:["Random","Overworld"+(body.className.indexOf(!0)?" Night":""),"Down"]}function pushRandomObstacle(xloc,i){var num=randTrue(3);switch(num>1&&(map.hadPipe=!1),num){case 0:case 1:if(i>1){addPipeRandom(xloc+8*i,0,8*(randTrue(2+(1==map.hadObstacle&&0==map.hadPipe&&i>7))+2)),map.hadObstacle=map.hadPipe=!0;break}case 2:for(var j=0;j<2;++j)randTrue()||i<1||(height=randTrue(2)+2,pushPreThing(Stone,xloc+8*(i+j),8*height,1,height));break;default:j=randTrue(2);switch(randTrue(7)){case 0:var height=randTrue(2)+1;if(pushPreThing(Cannon,xloc+8*(i+j),8*height,height),1==height&&randTrue(2)&&2!=j){var newheight=randTrue()+2;pushPreThing(Cannon,xloc+8*(i+j),8*height+8*newheight,newheight)}map.hadObstacle=!0;break;case 1:if(!map.underwater){randTrue()&&(!map.underwater&&randTrue(2)&&pushPreThing(Brick,xloc+8*i,jumplev1),pushPreThing(Block,xloc+8*(i+1),jumplev1,[Mushroom,1],!0),!map.underwater&&randTrue(2)&&pushPreThing(Brick,xloc+8*(i+2),jumplev1),map.hadObstacle=!0);break}case 2:if(!map.underwater){var offx=randTrue();offx||pushPreThing(Brick,xloc+8*i,jumplev1,getRandomBrickItem()),pushPreThing(Stone,xloc+8*(i+offx),jumplev1,2),addPipeRandom(xloc+8*(i+offx),jumplev1,24+8*randTrue()),offx&&pushPreThing(Brick,xloc+8*i,jumplev1,getRandomBrickItem());break}}}}function pushRandomSolidRow(xloc,yloc,len){for(var i=0;i<len;++i)randTrue(2)?pushPreThing(Brick,xloc+8*i,yloc,getRandomBrickItem("Overworld"==map.randname&&yloc==jumplev2)):pushPreThing(Block,xloc+8*i,yloc,getRandomBlockItem())}function getRandomBrickItem(higher,something){return higher&&!randTrue(14)?[Vine,["Random","Sky","Vine"]]:!(!something&&randTrue(7))&&(randTrue(3)?Coin:Star)}function getRandomBlockItem(){return++randcount_powerup,!(randcount_powerup<=7)&&(!randTrue(7)&&Mushroom)}function pushRandomGroundScenery(xloc,curblock,bwidth){switch(randTrue(7)){case 2:if(bwidth-curblock>4){pushPreScenery("Bush3",xloc,0);break}case 1:if(bwidth-curblock>2){pushPreScenery("Bush2",xloc,0);break}case 0:pushPreScenery("Bush1",xloc,0);break;case 3:if(bwidth-curblock>4){pushPreScenery("HillLarge",xloc,0);break}case 4:pushPreScenery("HillSmall",xloc,0);break;case 5:pushPreScenery("PlantLarge",xloc,0);break;case 6:pushPreScenery("PlantSmall",xloc,0);break;case 7:pushPreScenery("Fence",xloc,0,randTrue(2)+1)}}function pushRandomSkyScenery(xloc){switch(randTrue(2)){case 0:pushPreScenery("Cloud1",xloc,8*(randTrue(5)+5));break;case 1:pushPreScenery("Cloud2",xloc,8*(randTrue(4)+6));break;case 2:pushPreScenery("Cloud3",xloc,8*(randTrue(3)+7))}}function addDistanceCounter(){counter=createElement("div",{className:"indisplay counter randomdisplay",innerText:data.traveledold+" blocks traveled"}),body.appendChild(counter),TimeHandler.addEventInterval((function(counter){data.traveled=max(0,Math.round((player.right+gamescreen.left)/unitsizet8)-3),counter.innerText=data.traveledold+data.traveled+" blocks traveled"}),3,1/0,counter)}function addSeedDisplay(){}function createTunnel(xloc,width,btype){for(var top=randTrue(2)+3,bottom=randTrue(2)+2,hadenemy=!1,i=0;i<width;++i)fillPreThing(btype,xloc+8*i,8,1,bottom,8,8),randTrue(3)||hadenemy?hadenemy=!1:pushRandomSmallEnemy(xloc+8*i,8*bottom),fillPreThing(btype,xloc+8*i,96-8*top,1,top,8,8)}function removeRandomDisplays(){var i,elems=body.getElementsByClassName("randomdisplay");for(i=elems.length-1;i>=0;--i)body.removeChild(elems[i])}